
services:
  # Ray Head Node
  ray-head:
    image: rayproject/ray:2.9.0-py311  # Ray 2.9.0 with Python 3.11
    container_name: ray-head
    ports:
      - "8265:8265"  # Ray dashboard
      - "10001:10001"  # Ray client port
      - "6379:6379"  # Redis (GCS server)
    environment:
      - RAY_log_to_stderr=1
    command: >
      ray start --head --port=6379
               --dashboard-host=0.0.0.0
               --dashboard-port=8265
               --block
    networks:
      - helical-network

  # Ray Worker Nodes (scalable)
  ray-worker:
    image: rayproject/ray:2.9.0-py311
    container_name: ray-worker
    depends_on:
      - ray-head
    environment:
      - RAY_log_to_stderr=1
    command: >
      ray start --address=ray-head:6379
               --block
    networks:
      - helical-network

networks:
  helical-network:
    name: helical-network
    external: true